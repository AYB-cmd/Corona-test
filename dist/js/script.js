const questionner = [
    {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label"],
        "text": ["age"],
        "input": "input",
        "type": "text",
        "value": ' ',
        "name": "Q0",
        "R": []
    },
    {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },
    {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },
    {
        "Q": "Que pensez-vous de votre corps?",
        "element": ["label", "label", "label", "label"],
        "text": ["Bien", "Fatigue", "Moyen", "trop fatigue"],
        "input": "input",
        "type": "radio",
        "value": [1, 2, 1, 1],
        "name": "Q1",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "Pensez-vous avoir ou avoir eu de la fièvre ces derniers jours (frissons, sueurs) ?",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },   {
        "Q": "lakhar ...............................",
        "element": ["label", "label"],
        "text": ["NON", "OUI"],
        "input": "input",
        "type": "radio",
        "value": [1, 2],
        "name": "Q0",
        "R": []
    },
    {
        "msg" : [" Prenez contact avec votre médecin généraliste au moindre doute. Cette application n’est pour l’instant pas adaptée aux personnes de moins de 15 ans. En cas d’urgence, appeler le 15.",
    
                ]

    }
];

var contentAria = document.getElementById('terminal');
var progress = document.getElementById('progress');
var btnAria = document.getElementById('bot');
var startBtn = document.getElementById('start');
var backBtn = document.getElementById('backBtn');
var Nmr = document.querySelector('.index');
var question = document.querySelector('.question');
var reponse = document.querySelector('.reponse');
var counter = -1;
var result = [];
var R = 0;

// buttons
startBtn.addEventListener('click', startTest)
backBtn.addEventListener('click', back)
reponse.addEventListener('submit',e =>{e.preventDefault()})

function startTest() {
    
        getRps()
        
        counter++;
        questionNmrP();
        progressBarP();
        postQst();
        postRps();
        style();
        BtnChanges();
        postRslt(); 
        reprendre()
        
};

function back() {
    counter--;
    questionNmrP();
    progressBarP();
    postQst();
    postRps();
    questionner[counter].R.pop()
};

function questionNmrP() {
    if(counter <= 22)
    Nmr.innerHTML = `${counter + 1}/23`;
};

function progressBarP() {
    if (counter <= 0) {
        progress.style.width = '50%';
        backBtn.style.display = 'none'
    } if (counter >= 1 & counter <= 22) {
        progress.style.width = `${50 + (50 / 22) * counter}%`;
    } 
};

function style() {
    if (counter == 0) {
        contentAria.style.backgroundColor = '#FFF'
    }if (counter == 23) {
        contentAria.style.backgroundColor = '#96c5dc'

    }
};

function BtnChanges() {
    if (counter == 0) {
        btnAria.style.width = '100%';
        btnAria.style.display = 'flex';
        btnAria.style.justifyContent = 'flex-end';
        startBtn.setAttribute('form', 'FORM')
        startBtn.textContent = 'question suivante';
        startBtn.style.width = '45%';
        startBtn.style.margin = '1em 0';
    } if (counter == 1 & counter < 21) {
        btnAria.style.flexDirection = "row-reverse"
        btnAria.style.justifyContent = 'space-between';
        backBtn.textContent = "question d'avant";
        backBtn.style.display = 'block';
        startBtn.textContent = 'question suivante';
    }if (counter == 22) {
        startBtn.textContent = "Resultat";
        
    }
    if (counter == 23) {
        startBtn.textContent = "reprendre le test";
        backBtn.style.display = 'none';
        btnAria.style.width = '100%';
        btnAria.style.display = 'flex';
        btnAria.style.justifyContent = 'flex-end';
        startBtn.style.width = '100%';
        startBtn.style.maxWidth = '612px;'
        startBtn.style.margin = '0 auto .5em auto';
  
    }
};

function reprendre(){
    if (counter == 24){
        counter = -1;
        for (let i = 0; i < questionner.length; i++) {
            const element = questionner [i];
            element.R = [];
        }s
        startTest()
    }
};

// POSTINFO

function postQst() {
    if (counter >= 0 & counter <= 22) {
        question.innerHTML = '';
        var Q = document.createElement('h2');
        Q.textContent = questionner[counter].Q;
        question.appendChild(Q);

    }
};

function postRps() {
    if(counter >= 0 & counter <= 22){
    reponse.innerHTML = '';
    for (let i = 0; i < questionner[counter].element.length; i++) {
        var q = questionner[counter];
        var rps = document.createElement(questionner[counter].element[i]);
        rps.textContent = questionner[counter].text[i];
        reponse.appendChild(rps);
        reponse.lastChild.setAttribute('id', `${i}`);
        var selected = document.getElementById(`${i}`);
        var r = document.createElement(questionner[counter].input);
        r.type = q.type;
        r.value = q.value[i];
        r.name = q.name;
        r.required = true;
        selected.appendChild(r);
        selected.lastChild.setAttribute('class', 'tst')
    }
}

};

function postRslt(){
    if(counter == 23){
        question.innerHTML = '';
        var Q = document.createElement('h2');
        Q.textContent = questionner[counter].msg[R];
        question.appendChild(Q);
        Nmr.innerHTML = '';
        reponse.innerHTML = '';
    }
    
};
// GETINFO
function getRps() {
    
    if (counter >= 0 & counter <= 22) {
        var input = document.querySelectorAll(".tst")
        var r = questionner[counter].R
        for (let i = 0; i < input.length; i++) {
            const element = input[i];
            if (element.checked || element.type == "text") {
                var m = element.value;
                r.push(m);
            }
        }if (r.length == 0 || r[0] === " "){
            counter--
            r.pop()
            var q = questionner[counter];
        }
    }
    age()
};
////////////////////////////////////////////////////////////////////////
function age() {
    if (counter == 0 ) {
        if (questionner[0].R < 15){
            counter = 22
        }
    }
   
    
}



